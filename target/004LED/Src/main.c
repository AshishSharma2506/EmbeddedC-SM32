/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2023 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

// Section 18 and documentation

#include <stdint.h>

#if !defined(__SOFT_FP__) && defined(__ARM_FP)
  #warning "FPU is not initialized, but the project is compiling for an FPU. Please initialize the FPU before use."
#endif



int main(void)
{

	// creating the pointer variables
	// all peripheral registers are of 32 bits so chose uint32_t
	uint32_t *pClckCtrlreg   = (uint32_t*) 0x40023830;
	uint32_t *pPortDModereg  = (uint32_t*) 0x40020C00;
	uint32_t *pPortDOutreg   = (uint32_t*) 0x40020C14;

	/*
	//1. Enable the clock for GPIOD peripheral
	// as we know it is the 3rd bit (refer to ECB36(ii)
	// so to set the 3rd bit we have to use | (bitwise OR) for which the bit mask will be 0x0000 0008

	// let us first read the content of it
	uint32_t temp = *pClckCtrlreg; // dereferencing to read
	temp = temp | 0x08;  // bitwise OR
	// now write back to the address of the Clock control for our GPIOD
	*pClckCtrlreg = temp; // writing

	*/
	// we can write it in short as
	*pClckCtrlreg = *pClckCtrlreg | 0x08;
	// this can be even written shorter as shorthand C notation: *pClckCtrlreg |= 0x08;


	//2. configure the mode of the IO pin as output
	// refer to ECB 35 (ii) to see the bit position for 12th pin
	// so we need 24th bit as 1 and 25th bit as 0
	// that is set 24th bit and clear 25th bit
	// we will clear both the bit positon and then set the 24th
	// lect 120 8:00 bit mask value : 0xFCFF FFFF to clear and 0x 0100 0000

	// clear the 24th and 25th position
	*pPortDModereg &=  0xFCFFFFFF;

	// setting the 24th bit
	*pPortDModereg |= 0x01000000;


	//3. Set 12th bit of GPIOD output data resgiter to make i/o pin HIGH
	// bit mask value: 0x1000
	*pPortDOutreg |= 0x1000;

	while(1); // infinite loop to hang the application
}
